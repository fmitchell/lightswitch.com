<?php

/**
 * HOOKS
 */

/**
 * Implements hook_menu().
 */
function bxdev_sales_menu() {
  $items['sales/add/client'] = array(
    'title' => t('Create a New Video Project'),
		'page callback' => 'drupal_get_form',
    'page arguments' => array('bxdev_sales_create_client_form'),
    'access arguments' => array('access content'),
    'type' => MENU_CALLBACK,
  );

  return $items;
}

/**
 * FORMS
 */
function bxdev_sales_create_client_form(){
	
	$user_5 = user_load(5);
	dpm($user_5);
	
	$form = array();
	
	$form['new_existing_client'] = array(
	  '#type' => 'radios',
	  '#title' => t('new or existing client'),
	  '#options' => array(
			0 => 'new',
			1 => 'existing',
		),
	);	
	
	$form['business_name'] = array(
	  '#type' => 'textfield',
	  '#title' => t('business name'),
	);
	
	$form['category'] = array(
	  '#type' => 'select',
	  '#title' => t('category'),
	  '#options' => array(
			'cat1' => 'cat1',
			'cat2' => 'cat2',
		),
	);
	
	$form['price'] = array(
	  '#type' => 'select',
	  '#title' => t('price'),
	  '#options' => array(
			'price1' => 'price1',
			'price2' => 'price2',
		),
	);
	
	$form['website'] = array(
	  '#type' => 'textfield',
	  '#title' => t('website'),
	);
	
	$form['phone'] = array(
	  '#type' => 'textfield',
	  '#title' => t('phone'),
	);
	
	$form['email'] = array(
	  '#type' => 'textfield',
	  '#title' => t('email'),
	);
	
	$form['address'] = array(
	  '#type' => 'textfield',
	  '#title' => t('address'),
	);
	
	$form['hours_operation'] = array(
	  '#type' => 'textfield',
	  '#title' => t('hours of operation'),
	);
	
	$form['business_overview'] = array(
	  '#type' => 'textfield',
	  '#title' => t('business overview paragraph'),
	);
	
	$form['address'] = array(
	  '#type' => 'textfield',
	  '#title' => t('address'),
	);
	
	$form['social_name1'] = array(
	  '#type' => 'textfield',
	  '#title' => t('social media'),
	);
	
	$form['social_url1'] = array(
	  '#type' => 'textfield',
	);
	
	$form['social_name2'] = array(
	  '#type' => 'textfield',
	);
	
	$form['social_url2'] = array(
	  '#type' => 'textfield',
	);
	
	$form['social_name3'] = array(
	  '#type' => 'textfield',
	);
	
	$form['social_url3'] = array(
	  '#type' => 'textfield',
	);
	
	$form['social_name4'] = array(
	  '#type' => 'textfield',
	);
	
	$form['social_url4'] = array(
	  '#type' => 'textfield',
	);
	
	$form['pdf_label'] = array(
	  '#type' => 'textfield',
		'#title' => t('business PDF download'),
	);
	
	$form['pdf_file'] = array(
	  '#type' => 'file',
	);
	
	$form['submit'] = array(
	  '#type' => 'submit',
	  '#value' => t('Continue'),
	);	
	
	return $form;	
}

function bxdev_sales_create_client_form_submit($form, $form_state){
	
	$values = $form_state['values'];
	
	$file = file_save_upload('pdf_file', array('file_validate_extensions' => array('pdf', 'txt', 'doc' ,'docx')), 'public://');
	$file->display = 1;
	
	$account = new stdClass();
	$account->name = $values['email'];
	$account->mail = $values['email'];
	$account->pass = user_password();
	$account->roles = array(2 => 'authenticated user', 7 => 'client');
	$account->field_business_name['und'][0]['value'] = $values['business_name'];
	$account->field_business_category['und'][0]['value'] = $values['category'];
	$account->field_business_price['und'][0]['value'] = $values['price'];
	$account->field_website['und'][0]['value'] = $values['website'];
	$account->field_business_phone['und'][0]['value'] = $values['phone'];
	$account->field_business_address['und'][0]['value'] = $values['address'];
	$account->field_hours_operation['und'][0]['value'] = $values['hours_operation'];
	$account->field_business_overview['und'][0]['value'] = $values['business_overview'];
	$account->field_social_name1['und'][0]['value'] = $values['social_name1'];
	$account->field_social_url1['und'][0]['value'] = $values['social_url1'];
	$account->field_social_name2['und'][0]['value'] = $values['social_name2'];
	$account->field_social_url2['und'][0]['value'] = $values['social_url2'];
	$account->field_social_name3['und'][0]['value'] = $values['social_name3'];
	$account->field_social_url3['und'][0]['value'] = $values['social_url3'];
	$account->field_social_name4['und'][0]['value'] = $values['social_name4'];
	$account->field_social_url4['und'][0]['value'] = $values['social_url4'];
	
	$account->field_business_pdf_label['und'][0]['value'] = $values['pdf_label'];
	$account->field_business_pdf_download['und'][0] = (array)$file;
	
	$user = user_save($account);
	
}

/**
 * CUSTOM
 */
